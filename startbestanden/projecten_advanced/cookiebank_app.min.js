var cookieBank=function(c){var t=new Date,h={elements:{root:c("#view_welkom"),titel:c("#view_welkom > h4"),intro:c("#view_welkom .intro"),well:c("#view_welkom .well"),form:c("#view_welkom form"),btnInschrijven:c("#btnInschrijven"),inputVoornaam:c("input[name=voornaam]"),inputFamilienaam:c("input[name=familienaam]"),inputEmail:c("input[name=email]"),inputWachtwoord:c("input[name=wachtwoord]"),btnSubmit:c("#btnSubmit"),boodschapBox:c("#view_welkom div.alert")}},q={elements:{root:c("#view_klant"),titel:c("#view_klant > h4"),
    intro:c("#view_klant .intro"),well:c("#view_klant  .well"),form:c("#view_klant form"),inputSaldo:c("input[name=saldo]"),inputBedrag:c("input[name=bedrag]"),btnStorten:c("#btnStorten"),btnAfhalen:c("#btnAfhalen"),btnRekSluiten:c("#btnRekSluiten"),boodschapBox:c("#view_klant div.alert")}},u={elements:{root:c("#view_exit"),titel:c("#view_exit > h4"),boodschapBox:c("#view_exit div.alert"),welleen:c("#view_exit  .well.een"),welltwee:c("#view_exit  .well.twee"),btnTerug:c("#btnTerug"),btnBevestigRekSluiten:c("#btnBevestigRekSluiten"),
    btnGaDoor:c("#btnGaDoor")}},f={defaultView:h,currentView:h,adminKosten:{verrichting:1,afsluiten:5},startKapitaal:100},d={},r=function(b,a){for(var c in a||{})"object"===typeof a[c]?r(b[c],a[c]):b[c]=a[c]},e=function(b){this.name=b;this.view=void 0;this.boodschappen={}};e.prototype.init=function(){};e.prototype.updateView=function(){};e.prototype.debug=function(){var b="Controller "+this.name+" opgestart met view "+this.view.elements.root.attr("id");console.log(b)};e.prototype.showView=function(){f.currentView!=
this.view&&f.currentView.elements.root.hide();this.view.elements.root.show(300);f.currentView=this.view;console.log("showing view: "+this.view.elements.root)};e.prototype.hideView=function(){this.view.rootEl.hide();console.log("hiding view: "+this.view.elements.root)};e.prototype.toonBoodschappen=function(b){console.log(this.boodschappen);if(!c.isEmptyObject(this.boodschappen)){var a="",k;for(k in this.boodschappen)a+="<li>"+this.boodschappen[k]+"</li>";$foutBoks=this.view.elements.boodschapBox;$foutBoks.removeClass("alert-error alert-success alert-info alert-block").addClass(b);
    $foutBoks.find("ul").html(a);$foutBoks.show()}};e.prototype.verbergBoodschappen=function(){this.view.elements.boodschapBox.hide()};e.prototype.zetBoodschap=function(b){for(var a in b)this.boodschappen[a]=b[a]};e.prototype.clearBoodschappen=function(){this.boodschappen={}};e.prototype.validateBedrag=function(b){var a=b.val();console.log("validateBedrag, sBedrag: "+a);a=a.replace(/,/,".");if(c.isNumeric(a))return parseFloat(a);var a={},k="numeric_"+b.attr("name");a[k]="<strong>"+b.attr("name")+"</strong>: u moet een correct bedrag ingeven";
    this.zetBoodschap(a);return!1};e.prototype.validateTekst=function(b){var a=b.val();return""==a?(a={},a["text_ + el.attr('name"]="<strong>"+b.attr("name")+"</strong>: u moet een geldige tekst ingeven",this.zetBoodschap(a),!1):a};e.prototype.validateEmail=function(b){var a=b.val(),c=/^[a-z0-9!#$%&'*+/=?^_`{|}~.-]+@[a-z0-9-]+(\.[a-z0-9-]+)*$/i;if(""!=a&&c.test(a))return a;a={};c="email_"+b.attr("name");a[c]="<strong>"+b.attr("name")+"</strong>: dit is geen geldig emailadres";this.zetBoodschap(a);return!1};
    var m=new e("welkomController");m.initView=function(){this.clearBoodschappen();var b=this.view.elements;b.intro.html("Nu een rekening openen = "+f.startKapitaal+" &euro; startkapitaal ontvangen!");b.well.hide();b.inputVoornaam.val("");b.inputFamilienaam.val("");b.inputEmail.val("");b.inputWachtwoord.val("")};m.init=function(b){var a=this;this.view=b;this.debug();var c=this.view.elements;c.btnInschrijven.on("click",function(){c.well.show("slow")});c.btnSubmit.on("click",function(){var b=a.validateTekst(c.inputVoornaam),
        e=a.validateTekst(c.inputFamilienaam),g=a.validateEmail(c.inputEmail),h=a.validateTekst(c.inputWachtwoord);!1!==b&&!1!==e&&0!=g&&!1!==h?(d.voornaam=b,d.familienaam=e,d.email=g,d.wachtwoord=h,d.saldo=f.startKapitaal,n(d),l()):a.toonBoodschappen("alert-error")});c.intro.html("Nu een rekening openen = "+f.startKapitaal+" &euro; startkapitaal ontvangen!");this.initView();this.showView()};var g=new e("klantController");g.init=function(b){var a=this;this.view=b;this.debug();var c=this.view.elements;c.btnStorten.on("click",
        function(){var b=c.inputBedrag,d=a.validateBedrag(b);!1===d?(a.toonBoodschappen("alert-error"),b.val("")):(a.clearBoodschappen(),a.verbergBoodschappen(),a.storten(d),a.updateView())});c.btnAfhalen.on("click",function(){var b=c.inputBedrag,d=a.validateBedrag(b);!1!==d?(d=a.afhalen(d),!0!==d?(b.val(d),b.focus(),a.toonBoodschappen("alert-error")):(a.clearBoodschappen(),a.verbergBoodschappen(),a.updateView())):a.toonBoodschappen("alert-error")});c.btnRekSluiten.on("click",function(){p.init(u)});this.updateView();
        c.intro.html("Cookiebank rekent"+f.adminKosten.verrichting+" &euro; per verrichting");this.showView()};g.storten=function(b){d.saldo+=b;n(d);return!0};g.afhalen=function(b){var a=d.saldo-b-f.adminKosten.verrichting;if(0>a)return b=d.saldo-f.adminKosten.verrichting,a="Uw saldo is onvoldoende om dit bedrag af te halen. "+("Hou ook rekening met de administratieve kosten van "+f.adminKosten.verrichting+"&euro;"),this.zetBoodschap({onvoldoendeSaldo:a+(" U kunt maximaal "+b+" &euro; afhalen.")}),b;d.saldo=
        a;n(d);console.log("bedrag afgehaald: "+b);return!0};g.updateView=function(){var b=this.view.elements;b.titel.html("welkom "+d.voornaam);b.inputSaldo.val(d.saldo);b.inputBedrag.val("")};var p=new e("exitController");p.init=function(b){var a=this;this.view=b;this.debug();var c=this.view.elements;c.btnTerug.on("click",function(){a.clearBoodschappen();a.verbergBoodschappen();l()});c.btnBevestigRekSluiten.on("click",function(){!0===a.rekAfsluiten()?(c.welleen.hide(),c.welltwee.show(),a.toonBoodschappen("alert-info")):
        a.toonBoodschappen("alert-error")});c.btnGaDoor.on("click",function(){l()});this.showView()};p.rekAfsluiten=function(){var b=d.saldo-f.adminKosten.afsluiten;if(0>b){var a="Het resterende saldo, "+d.saldo,a=a+(" (\u20ac), is onvoldoende om de administratieve kosten, "+f.adminKosten.afsluiten),a=a+" &euro;, voor het afsluiten van uw rekening op te vangen. <br>We kunnen uw rekening helaas niet afsluiten, gelieve uw lokaal bankkantoor te raadplegen.",a={onvoldoendeAfsluiten:a};this.zetBoodschap(a);return!1}c.removeCookie("klant");
        d={};a="Uw rekening werd afgesloten <br>"+("U ontvangt het resterende saldo,("+d.saldo+" &euro;), minus de administratieve kosten,("+f.adminKosten.afsluiten+"&euro;)<br>");a+="Cookiebank dankt u voor het vertrouwen, hopelijk tot ziens!";a={afsluiten:a};this.zetBoodschap(a);console.log("rekening afgesloten met restbedrag: "+b);return!0};var n=function(b){var a=JSON.stringify(b);console.log("oKoekie: "+b);c.cookie("klant",a);console.log("cookie geschreven: "+a)},l=function(){if(c.isEmptyObject(d)){var b;
        c.cookie("klant")?(b=c.cookie("klant"),d.voornaam=b.voornaam,d.familienaam=b.familienaam,d.email=b.email,d.wachtwoord=b.wachtwoord,d.saldo=b.saldo,console.log("oKlant: "+d),b=!0):(console.log("cookie niet gevonden: "),b=!1);!1===b?m.init(h):g.init(q)}else g.init(q)};return{init:function(b){c.cookie.json=!0;var a=t.toLocaleTimeString();r(f,b);l();return"cookieBank opgestart op "+a}}}(jQuery);/**
 * Created by cyber05 on 11/05/2015.
 */
